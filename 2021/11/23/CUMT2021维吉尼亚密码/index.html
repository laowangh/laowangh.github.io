<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"><title>维吉尼亚密码的学习 | 菜狗呜呜呜</title><meta name="keywords" content="密码学,重合指数,python3"><meta name="author" content="Wang_sang"><meta name="copyright" content="Wang_sang"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="算是密码学的学习过程">
<meta property="og:type" content="article">
<meta property="og:title" content="维吉尼亚密码的学习">
<meta property="og:url" content="https://laowangh.github.io/2021/11/23/CUMT2021%E7%BB%B4%E5%90%89%E5%B0%BC%E4%BA%9A%E5%AF%86%E7%A0%81/index.html">
<meta property="og:site_name" content="菜狗呜呜呜">
<meta property="og:description" content="算是密码学的学习过程">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/laowangh/cdn@3.0/source/images/thumb/h (5).jpg">
<meta property="article:published_time" content="2021-11-23T12:42:13.000Z">
<meta property="article:modified_time" content="2021-11-30T16:21:20.384Z">
<meta property="article:author" content="Wang_sang">
<meta property="article:tag" content="密码学">
<meta property="article:tag" content="重合指数">
<meta property="article:tag" content="python3">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://cdn.jsdelivr.net/gh/laowangh/cdn@3.0/source/images/thumb/h (5).jpg"><link rel="shortcut icon" href="/img/h%20(1).png"><link rel="canonical" href="https://laowangh.github.io/2021/11/23/CUMT2021%E7%BB%B4%E5%90%89%E5%B0%BC%E4%BA%9A%E5%AF%86%E7%A0%81/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"search.xml","languages":{"hits_empty":"找不到您查询的内容：${query}"}},
  translate: {"defaultEncoding":2,"translateDelay":0,"msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"簡"},
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '天',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: {"limitCount":50,"languages":{"author":"作者: Wang_sang","link":"链接: ","source":"来源: 菜狗呜呜呜","info":"著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。"}},
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery@2/dist/fjGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery@2/dist/fjGallery.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: '维吉尼亚密码的学习',
  isPost: true,
  isHome: false,
  isHighlightShrink: true,
  isToc: true,
  postUpdate: '2021-12-01 00:21:20'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><meta name="generator" content="Hexo 5.4.0"></head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="/img/%E5%A4%B4%E5%83%8F1.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data is-center"><div class="data-item"><a href="/archives/"><div class="headline">文章</div><div class="length-num">6</div></a></div><div class="data-item"><a href="/tags/"><div class="headline">标签</div><div class="length-num">12</div></a></div><div class="data-item"><a href="/categories/"><div class="headline">分类</div><div class="length-num">5</div></a></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归档</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('https://cdn.jsdelivr.net/gh/laowangh/cdn@3.0/source/images/thumb/h (5).jpg')"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">菜狗呜呜呜</a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> 搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归档</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">维吉尼亚密码的学习</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2021-11-23T12:42:13.000Z" title="发表于 2021-11-23 20:42:13">2021-11-23</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2021-11-30T16:21:20.384Z" title="更新于 2021-12-01 00:21:20">2021-12-01</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E5%AF%86%E7%A0%81%E5%AD%A6/">密码学</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">字数总计:</span><span class="word-count">3.3k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>14分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="维吉尼亚密码的学习"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h1 id="0x01-简单的多表代换"><a href="#0x01-简单的多表代换" class="headerlink" title="0x01 简单的多表代换"></a>0x01 简单的多表代换</h1><p>Vigenenre密码是最著名的多表代换密码，是法国著名密码学家Vigenenre发明的。Vigenenre密码使用一个词组作为密钥，密钥中每一个字母用来确定一个代换表，每一个密钥字母被用来加密一个明文字母，第一个密钥字母加密第一个明文字母，第二个密钥字母加密第二个明文字母，等所有密钥字母使用完后，密钥再次循环使用。</p>
<p><img src="20180910173109_58996.png" alt="img"></p>
<p>例如：</p>
<p><img src="20180910173353_81009.png" alt="img"></p>
<p>这样我们可以先构造加密函数和解密函数：</p>
<blockquote>
<p>输入只有英文字母。</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#加密函数</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">Encrypto</span>(<span class="params">m,key</span>):</span></span><br><span class="line">	mlen=<span class="built_in">len</span>(m)</span><br><span class="line">	klen=<span class="built_in">len</span>(key)</span><br><span class="line">	<span class="comment"># 都转换为大写字母</span></span><br><span class="line">	m=m.upper()</span><br><span class="line">	key=key.upper()</span><br><span class="line">	p=<span class="string">&quot;&quot;</span></span><br><span class="line">	<span class="comment">#开始加密</span></span><br><span class="line">	<span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, mlen):</span><br><span class="line">		j=i%klen</span><br><span class="line">		p+=<span class="built_in">chr</span>(((<span class="built_in">ord</span>(m[i])-<span class="number">65</span>)+(<span class="built_in">ord</span>(key[j])-<span class="number">65</span>))%<span class="number">26</span>+<span class="number">65</span>)</span><br><span class="line">	<span class="keyword">return</span> p</span><br><span class="line"><span class="comment"># 解密函数</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">Decrypto</span>(<span class="params">p,key</span>):</span></span><br><span class="line">	plen=<span class="built_in">len</span>(p)</span><br><span class="line">	klen=<span class="built_in">len</span>(key)</span><br><span class="line">    p=p.upper()</span><br><span class="line">    key=key.upper()</span><br><span class="line">	m=<span class="string">&quot;&quot;</span></span><br><span class="line">	<span class="comment">#开始解密</span></span><br><span class="line">	<span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, plen):</span><br><span class="line">		j=i%klen</span><br><span class="line">		m+=<span class="built_in">chr</span>(((<span class="built_in">ord</span>(p[i])-<span class="number">65</span>)-((<span class="built_in">ord</span>(key[j])-<span class="number">65</span>)%<span class="number">26</span>)+<span class="number">26</span>)%<span class="number">26</span>+<span class="number">65</span>)</span><br><span class="line">	<span class="keyword">return</span> m</span><br></pre></td></tr></table></figure>

<p>一个简单的加解密：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> string</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="comment">#加密函数</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">Encrypto</span>(<span class="params">m,key</span>):</span></span><br><span class="line">	mlen=<span class="built_in">len</span>(m)</span><br><span class="line">	klen=<span class="built_in">len</span>(key)</span><br><span class="line">	<span class="comment"># 都转换为大写字母</span></span><br><span class="line">	m=m.upper()</span><br><span class="line">	key=key.upper()</span><br><span class="line">	p=<span class="string">&quot;&quot;</span></span><br><span class="line">	<span class="comment">#开始加密</span></span><br><span class="line">	<span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, mlen):</span><br><span class="line">		j=i%klen</span><br><span class="line">		p+=<span class="built_in">chr</span>(((<span class="built_in">ord</span>(m[i])-<span class="number">65</span>)+(<span class="built_in">ord</span>(key[j])-<span class="number">65</span>))%<span class="number">26</span>+<span class="number">65</span>)</span><br><span class="line">	<span class="keyword">return</span> p</span><br><span class="line"></span><br><span class="line"><span class="comment"># 解密函数</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">Decrypto</span>(<span class="params">p,key</span>):</span></span><br><span class="line">	plen=<span class="built_in">len</span>(p)</span><br><span class="line">	klen=<span class="built_in">len</span>(key)</span><br><span class="line">	key=key.upper()</span><br><span class="line">	m=<span class="string">&quot;&quot;</span></span><br><span class="line">	<span class="comment">#开始解密</span></span><br><span class="line">	<span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, plen):</span><br><span class="line">		j=i%klen</span><br><span class="line">		m+=<span class="built_in">chr</span>(((<span class="built_in">ord</span>(p[i])-<span class="number">65</span>)-((<span class="built_in">ord</span>(key[j])-<span class="number">65</span>)%<span class="number">26</span>)+<span class="number">26</span>)%<span class="number">26</span>+<span class="number">65</span>)</span><br><span class="line">	<span class="keyword">return</span> m</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span>():</span></span><br><span class="line">	<span class="keyword">while</span> (<span class="literal">True</span>):</span><br><span class="line">		choice = <span class="built_in">input</span>(<span class="string">&quot;加密请输入1 解密请输入2: &quot;</span>)</span><br><span class="line">		<span class="keyword">if</span> choice == <span class="string">&#x27;1&#x27;</span>:</span><br><span class="line">			m = <span class="built_in">input</span>(<span class="string">&quot;请输入明文: &quot;</span>)</span><br><span class="line">			key = <span class="built_in">input</span>(<span class="string">&quot;请输入密钥: &quot;</span>)</span><br><span class="line">			p=Encrypto(m, key)</span><br><span class="line">			<span class="built_in">print</span>(<span class="string">&quot;加密后的密文是: %s&quot;</span> % p)</span><br><span class="line">		<span class="keyword">elif</span> choice == <span class="string">&#x27;2&#x27;</span>:</span><br><span class="line">			p = <span class="built_in">input</span>(<span class="string">&quot;请输入密文: &quot;</span>)</span><br><span class="line">			key = <span class="built_in">input</span>(<span class="string">&quot;请输入密钥: &quot;</span>)</span><br><span class="line">			m=Decrypto(p, key)</span><br><span class="line">			<span class="built_in">print</span>(<span class="string">&quot;解密后的明文是: %s&quot;</span> % m)</span><br><span class="line">		<span class="keyword">else</span>:</span><br><span class="line">			<span class="built_in">print</span>(<span class="string">&quot;不存在该口令&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">	main()</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">运行结果：</span><br><span class="line">加密请输入1 解密请输入2: 1</span><br><span class="line">请输入明文: sedagaetjaet</span><br><span class="line">请输入密钥: abc</span><br><span class="line">加密后的密文是: SFFAHCEULAFV</span><br><span class="line">加密请输入1 解密请输入2: 2</span><br><span class="line">请输入密文: SFFAHCEULAFV</span><br><span class="line">请输入密钥: abc</span><br><span class="line">解密后的明文是: SEDAGAETJAET</span><br></pre></td></tr></table></figure>

<blockquote>
<p>对于单表代换，假如<strong>’P‘</strong>是密文中出现次数最多的字母，则<strong>’P‘</strong>所代表的明文很有可能是’E‘（在明文为英文的前提下）,因为E是经过统计后所有字母里频率最大的字母。由此可见，运用统计的方法的确有助于我们破解这类代换密码。</p>
</blockquote>
<p>维吉尼亚密码也有着很明显的漏洞。如果我们知道了密钥的长度，那密文就可以被看作是交织在一起的恺撒密码。根据密钥长度我们可以将密文进行分组，每一组各自的偏移量都是相同的，从而每一组进行单独破解。那么，重点就变成了如何判断密钥长度，下面介绍两种方法。</p>
<h1 id="0x02-卡希斯基试验"><a href="#0x02-卡希斯基试验" class="headerlink" title="0x02 卡希斯基试验"></a>0x02 卡希斯基试验</h1><blockquote>
<p>卡西斯基试验是基于类似the这样的常用单词有可能被同样的密钥字母进行加密，从而在密文中重复出现。</p>
<p>例如：</p>
<ul>
<li>明文：CRYPTO IS SHORT FOR CRYPTOGRAPHY</li>
<li>密钥：ABCD</li>
<li>密文：<em><strong>CSASTP</strong></em>KV SIQUT GQU <em><strong>CSASTP</strong></em>IUAQJB </li>
</ul>
<p>此时重复出现的位置为1和17，那么密钥长度就有可能是16的一个公因数，这些公因数为一组。段落越长越好，求出n组公因数后，求这些公因数的交集，那么可以大致确定密钥长度。</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#	Q求所有因数</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">yinshu</span>(<span class="params">num</span>):</span></span><br><span class="line">    yinshus = []</span><br><span class="line">    times = <span class="built_in">int</span>(math.sqrt(num))</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,times):</span><br><span class="line">        <span class="keyword">if</span> num % i == <span class="number">0</span>:</span><br><span class="line">            yinshus.append(i)</span><br><span class="line">            t = <span class="built_in">int</span>(num / i)</span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">not</span> t == i:</span><br><span class="line">                yinshus.append(t)</span><br><span class="line">    yinshus.sort()</span><br><span class="line">    <span class="keyword">return</span> yinshus</span><br><span class="line"></span><br><span class="line"><span class="comment"># 卡希斯基实验</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">kaxisiji</span>(<span class="params">s</span>):</span></span><br><span class="line">	s1=<span class="string">&quot;&quot;</span></span><br><span class="line">	<span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">3</span>):</span><br><span class="line">		s1+=s[x]</span><br><span class="line">	st= [each.start() <span class="keyword">for</span> each <span class="keyword">in</span> re.finditer(s1, s)]</span><br><span class="line">	h=<span class="built_in">len</span>(st)-<span class="number">1</span></span><br><span class="line">	nu=st[h]-st[h-<span class="number">1</span>]</span><br><span class="line">	gy=yinshu(nu)</span><br><span class="line">	c=gy</span><br><span class="line">	<span class="keyword">while</span> h&gt;=<span class="number">1</span>:</span><br><span class="line">		num=st[h]-st[h-<span class="number">1</span>]</span><br><span class="line">		gys=yinshu(num)</span><br><span class="line">		h-=<span class="number">1</span></span><br><span class="line">		c=[x <span class="keyword">for</span> x <span class="keyword">in</span> c <span class="keyword">if</span> x <span class="keyword">in</span> gys]</span><br><span class="line">	<span class="keyword">return</span> c</span><br></pre></td></tr></table></figure>

<blockquote>
<p>经过检验，卡希斯基法并不是完全能够确定密钥长度，有时候会出现空集的情况。单个重合指数也不好确定密钥长度，会出现密钥重复的情况或者密钥过长，建议两者结合，可能会更准确一点。</p>
</blockquote>
<h1 id="0x03-重合指数"><a href="#0x03-重合指数" class="headerlink" title="0x03 重合指数"></a>0x03 重合指数</h1><p><strong>重合指数</strong>：即相当于求在某个密文中随机无放回地抽取其中的两位，这两位的字母相同的概率。</p>
<p><img src="image-20211130115245680.png"></p>
<blockquote>
<p>n=26,<em>f<del>i</del><em>是字母“i”出现在文本中的频率，</em>L</em>是文本的长度。</p>
</blockquote>
<blockquote>
<p>一段完全随机的文本中，重合指数更接近0.038。但是任意一个单表替换加密的密文中，可以认为因为只是换了字母的长相，所以虽然文本看起来无意义，但这个统计特性仍然为正常语义的英文文本的性质，更接近于0.068。因此，我们可以利用这个特性破译这类密码。</p>
<p>已知单表代换重合指数接近0.068，像维吉尼亚密码这类周期性多表代换(字母随机分布)，其重合指数更接近于0.038。故我们可以通过重合指数判断加密为单表代换还是多表代换。</p>
<p>维吉尼亚密码可以被分解为若干组平移密码来破译，而一个明文足够长的平移密码的重合指数接近0.068。即如果我们选取某个k值，使得分组后的密文的重合指数接近0.068，则说明选取的k值与密钥的长度是一致的。</p>
</blockquote>
<p>了解过程就好办了，上代码！</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#词频统计  返回每个字母出现的次数</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">tongji</span>(<span class="params">s</span>):</span></span><br><span class="line">	a=<span class="string">&quot;ABCDEFGHIJKLMNOPQRSTUVWXYZ&quot;</span></span><br><span class="line">	num=[]</span><br><span class="line">	<span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">26</span>):</span><br><span class="line">		b=s.count(a[x])</span><br><span class="line">		num.append(b)</span><br><span class="line">	<span class="keyword">return</span> num</span><br><span class="line"><span class="comment">#进行分组 s是要进行分组的字符串，t为字符串的长度 返回一个分组列表</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">fenzu</span>(<span class="params">s,t</span>):</span></span><br><span class="line">	slen=<span class="built_in">len</span>(s)</span><br><span class="line">	flag=p=<span class="number">0</span></span><br><span class="line">	q=math.ceil(slen/t)</span><br><span class="line">	m=t-slen%t</span><br><span class="line">	b=<span class="string">&quot;&quot;</span></span><br><span class="line">	<span class="keyword">for</span> c <span class="keyword">in</span> <span class="built_in">range</span>(m):</span><br><span class="line">		b+=<span class="string">&quot; &quot;</span></span><br><span class="line">	st=s+b</span><br><span class="line">	s_fen=[]</span><br><span class="line">	<span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(t):	</span><br><span class="line">		j=[]</span><br><span class="line">		s_fen.append(j)</span><br><span class="line">		p=flag</span><br><span class="line">		<span class="keyword">for</span> h <span class="keyword">in</span> <span class="built_in">range</span>(q):</span><br><span class="line">			j.append(st[p])</span><br><span class="line">			p+=t</span><br><span class="line">		flag+=<span class="number">1</span></span><br><span class="line">	<span class="keyword">return</span> s_fen</span><br><span class="line"><span class="comment">#计算重合指数 </span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">chong</span>(<span class="params">s,num</span>):</span></span><br><span class="line">	IC=<span class="number">0</span></span><br><span class="line">	sl=<span class="built_in">len</span>(s)</span><br><span class="line">	<span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">26</span>):</span><br><span class="line">		IC=IC+((num[i]-<span class="number">1</span>)*num[i])/((sl*(sl-<span class="number">1</span>)))</span><br><span class="line">	<span class="keyword">return</span> IC</span><br><span class="line"><span class="comment">#计算密钥长度为x时的重合指数</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">keylength</span>(<span class="params">s,x</span>):</span></span><br><span class="line">	IC=<span class="number">0</span></span><br><span class="line">	s_list=fenzu(s,x)</span><br><span class="line">	<span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(x):	</span><br><span class="line">		num=tongji(s_list[i-<span class="number">1</span>])</span><br><span class="line">		IC+=chong(s_list[i-<span class="number">1</span>],num)</span><br><span class="line">	IC=IC/x</span><br><span class="line">	<span class="keyword">return</span> IC	</span><br><span class="line"><span class="comment">#判断密钥长度 卡希斯基和重合指数双重验证</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">miyaochang</span>(<span class="params">s</span>):</span></span><br><span class="line">	c=kaxisiji(s)</span><br><span class="line">	<span class="keyword">if</span> c:</span><br><span class="line">		b=c.pop()+<span class="number">1</span></span><br><span class="line">	<span class="keyword">else</span>: b=<span class="number">31</span></span><br><span class="line">	k=<span class="number">0</span></span><br><span class="line">	f=<span class="number">0</span></span><br><span class="line">	<span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,b):</span><br><span class="line">		IC=keylength(s,i)</span><br><span class="line">		<span class="keyword">if</span>(k&lt;IC):</span><br><span class="line">			k=IC</span><br><span class="line">			f=i</span><br><span class="line">	<span class="keyword">return</span> f</span><br></pre></td></tr></table></figure>

<h1 id="0x04-拟重合指数"><a href="#0x04-拟重合指数" class="headerlink" title="0x04 拟重合指数"></a>0x04 拟重合指数</h1><p>判断完密钥长度后，对每个分组，我们可以通过过拟重合指数判断每组偏移量。</p>
<blockquote>
<p>利用统计规律，IC=$\sum_{i=1}^n$ p<del>i</del>*(n<del>i</del>/L) 。 n为26，n<del>i</del>为字母出现频次，L为分组长度，p<del>i</del>为每个字母的统计出现概率。利用拟重合指数，当偏移为k时，我们可以求拟重合指数，若拟重合指数最接近0.068，代表k值为该组偏移量。</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#计算拟重合指数,判断分组偏移量</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">nichong</span>(<span class="params">s_biao,kl</span>):</span> <span class="comment"># kl为密钥长度，s_biao是已经分好组的表</span></span><br><span class="line">	w = [<span class="number">0.08166999999999999</span>, <span class="number">0.01492</span>, <span class="number">0.02782</span>, <span class="number">0.04253</span>, <span class="number">0.12702</span>, <span class="number">0.02228</span>, <span class="number">0.02015</span>, <span class="number">0.06094</span>, <span class="number">0.06966</span>, <span class="number">0.00153</span>, <span class="number">0.00772</span>, <span class="number">0.04025</span>, <span class="number">0.02406</span>, <span class="number">0.06749</span>, <span class="number">0.07507</span>, <span class="number">0.01929</span>, <span class="number">0.00095</span>, <span class="number">0.05987</span>, <span class="number">0.06326999999999999</span>, <span class="number">0.09055999999999999</span>, <span class="number">0.02758</span>, <span class="number">0.00978</span>, <span class="number">0.0236</span>, <span class="number">0.0015</span>, <span class="number">0.01974</span>, <span class="number">0.00074</span>]</span><br><span class="line">	a=<span class="string">&quot;ABCDEFGHIJKLMNOPQRSTUVWXYZ&quot;</span></span><br><span class="line">	v=[]</span><br><span class="line">	k=<span class="number">0</span></span><br><span class="line">	M=<span class="number">0</span></span><br><span class="line">	m=s=<span class="string">&quot;&quot;</span></span><br><span class="line">	<span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(kl):</span><br><span class="line">		v.append(<span class="number">0</span>)</span><br><span class="line">	<span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(kl):</span><br><span class="line">		s_biao[j]=cqu(s_biao[j])</span><br><span class="line">		<span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">26</span>):  <span class="comment">#计算偏移量的</span></span><br><span class="line">			<span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(s_biao[j])):</span><br><span class="line">				m+=<span class="built_in">chr</span>(((<span class="built_in">ord</span>(s_biao[j][i])-<span class="number">65</span>)-((<span class="built_in">ord</span>(a[x])-<span class="number">65</span>)%<span class="number">26</span>)+<span class="number">26</span>)%<span class="number">26</span>+<span class="number">65</span>)</span><br><span class="line">			num=tongji(m)</span><br><span class="line">			<span class="keyword">for</span> e <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">26</span>):</span><br><span class="line">				M=M+(w[e]*num[e]/<span class="built_in">len</span>(s_biao[<span class="number">0</span>]))</span><br><span class="line">			<span class="keyword">if</span>(k&lt;M):</span><br><span class="line">				k=M</span><br><span class="line">				v[j]=x</span><br><span class="line">			m=<span class="string">&quot;&quot;</span></span><br><span class="line">			M=<span class="number">0</span></span><br><span class="line">		k=<span class="number">0</span></span><br><span class="line">	<span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(kl):</span><br><span class="line">		s+=<span class="built_in">chr</span>(v[j]+<span class="number">65</span>)</span><br><span class="line">	<span class="keyword">return</span> s</span><br></pre></td></tr></table></figure>

<h1 id="0x05-最终结果"><a href="#0x05-最终结果" class="headerlink" title="0x05 最终结果"></a>0x05 最终结果</h1><p>现在，我们完善一下加解密函数，增加对输入密文和输出格式（五个一组看着舒服，不要纠结这个）的处理。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> string</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> math</span><br><span class="line"><span class="keyword">import</span> wordninja</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="comment">#加密函数</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">Encrypto</span>(<span class="params">m,key</span>):</span></span><br><span class="line">	m=cqu(m)</span><br><span class="line">	mlen=<span class="built_in">len</span>(m)</span><br><span class="line">	klen=<span class="built_in">len</span>(key)</span><br><span class="line">	<span class="comment"># 都转换为大写字母</span></span><br><span class="line">	m=m.upper()</span><br><span class="line">	key=key.upper()</span><br><span class="line">	p=<span class="string">&quot;&quot;</span></span><br><span class="line">	<span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, mlen):</span><br><span class="line">		j=i%klen</span><br><span class="line">		p+=<span class="built_in">chr</span>(((<span class="built_in">ord</span>(m[i])-<span class="number">65</span>)+(<span class="built_in">ord</span>(key[j])-<span class="number">65</span>))%<span class="number">26</span>+<span class="number">65</span>)</span><br><span class="line">    <span class="comment">#为了补齐分组最后不够的情况，要不然输出有问题，当然纯粹没必要写</span></span><br><span class="line">	i=<span class="number">5</span>-mlen%<span class="number">5</span></span><br><span class="line">	b=<span class="string">&quot;&quot;</span></span><br><span class="line">	<span class="keyword">for</span> c <span class="keyword">in</span> <span class="built_in">range</span>(i):</span><br><span class="line">		b+=<span class="string">&quot; &quot;</span></span><br><span class="line">	st=p+b</span><br><span class="line">	new_text = <span class="string">&quot; &quot;</span>.join(re.findall(<span class="string">&quot;.&#123;5&#125;&quot;</span>,st))  </span><br><span class="line">	<span class="keyword">return</span> new_text</span><br><span class="line"><span class="comment"># 解密函数</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">Decrypto</span>(<span class="params">p,key</span>):</span></span><br><span class="line">	p=cqu(p)</span><br><span class="line">	plen=<span class="built_in">len</span>(p)</span><br><span class="line">	klen=<span class="built_in">len</span>(key)</span><br><span class="line">	p=p.upper()</span><br><span class="line">	key=key.upper()</span><br><span class="line">	m=<span class="string">&quot;&quot;</span></span><br><span class="line">	<span class="comment">#开始解密</span></span><br><span class="line">	<span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, plen):</span><br><span class="line">		j=i%klen</span><br><span class="line">		m+=<span class="built_in">chr</span>(((<span class="built_in">ord</span>(p[i])-<span class="number">65</span>)-((<span class="built_in">ord</span>(key[j])-<span class="number">65</span>)%<span class="number">26</span>)+<span class="number">26</span>)%<span class="number">26</span>+<span class="number">65</span>)</span><br><span class="line">	m=m.lower()</span><br><span class="line">	jieguo=wordninja.split(m)</span><br><span class="line">	result = <span class="string">&quot; &quot;</span>.join(jieguo)</span><br><span class="line">	<span class="keyword">return</span> result</span><br><span class="line"><span class="comment">#	Q求所有因数</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">yinshu</span>(<span class="params">num</span>):</span></span><br><span class="line">    yinshus = []</span><br><span class="line">    times = <span class="built_in">int</span>(math.sqrt(num))</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,times):</span><br><span class="line">        <span class="keyword">if</span> num % i == <span class="number">0</span>:</span><br><span class="line">            yinshus.append(i)</span><br><span class="line">            t = <span class="built_in">int</span>(num / i)</span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">not</span> t == i:</span><br><span class="line">                yinshus.append(t)</span><br><span class="line">    yinshus.sort()</span><br><span class="line">    <span class="keyword">return</span> yinshus</span><br><span class="line"><span class="comment"># 卡希斯基实验</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">kaxisiji</span>(<span class="params">s</span>):</span></span><br><span class="line">	s1=<span class="string">&quot;&quot;</span></span><br><span class="line">	<span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">3</span>):</span><br><span class="line">		s1+=s[x]</span><br><span class="line">	st= [each.start() <span class="keyword">for</span> each <span class="keyword">in</span> re.finditer(s1, s)]</span><br><span class="line">	h=<span class="built_in">len</span>(st)-<span class="number">1</span></span><br><span class="line">	nu=st[h]-st[h-<span class="number">1</span>]</span><br><span class="line">	gy=yinshu(nu)</span><br><span class="line">	c=gy</span><br><span class="line">	<span class="keyword">while</span> h&gt;=<span class="number">1</span>:</span><br><span class="line">		num=st[h]-st[h-<span class="number">1</span>]</span><br><span class="line">		gys=yinshu(num)</span><br><span class="line">		h-=<span class="number">1</span></span><br><span class="line">		c=[x <span class="keyword">for</span> x <span class="keyword">in</span> c <span class="keyword">if</span> x <span class="keyword">in</span> gys]</span><br><span class="line">	<span class="keyword">return</span> c</span><br><span class="line"><span class="comment">#进行分组</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">fenzu</span>(<span class="params">s,t</span>):</span></span><br><span class="line">	slen=<span class="built_in">len</span>(s)</span><br><span class="line">	flag=p=<span class="number">0</span></span><br><span class="line">	q=math.ceil(slen/t)</span><br><span class="line">	m=t-slen%t</span><br><span class="line">	b=<span class="string">&quot;&quot;</span></span><br><span class="line">	<span class="keyword">for</span> c <span class="keyword">in</span> <span class="built_in">range</span>(m):</span><br><span class="line">		b+=<span class="string">&quot; &quot;</span></span><br><span class="line">	st=s+b</span><br><span class="line">	s_fen=[]</span><br><span class="line">	<span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(t):	</span><br><span class="line">		j=[]</span><br><span class="line">		s_fen.append(j)</span><br><span class="line">		p=flag</span><br><span class="line">		<span class="keyword">for</span> h <span class="keyword">in</span> <span class="built_in">range</span>(q):</span><br><span class="line">			j.append(st[p])</span><br><span class="line">			p+=t</span><br><span class="line">		flag+=<span class="number">1</span></span><br><span class="line">	<span class="keyword">return</span> s_fen	</span><br><span class="line"><span class="comment">#判断密钥长度</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">miyaochang</span>(<span class="params">s</span>):</span></span><br><span class="line">	c=kaxisiji(s)</span><br><span class="line">	<span class="keyword">if</span> c:</span><br><span class="line">		b=c.pop()+<span class="number">1</span></span><br><span class="line">	<span class="keyword">else</span>: b=<span class="number">31</span></span><br><span class="line">	k=<span class="number">0</span></span><br><span class="line">	f=<span class="number">0</span></span><br><span class="line">	<span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,b):</span><br><span class="line">		IC=keylength(s,i)</span><br><span class="line">		<span class="keyword">if</span>(k&lt;IC):</span><br><span class="line">			k=IC</span><br><span class="line">			f=i</span><br><span class="line">	<span class="keyword">return</span> f		</span><br><span class="line"><span class="comment">#去掉非字母后密文</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">cqu</span>(<span class="params">c</span>):</span>   </span><br><span class="line">    ci = <span class="string">&#x27;&#x27;</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(c)):</span><br><span class="line">        <span class="keyword">if</span> (c[i].isalpha()):</span><br><span class="line">            ci += c[i]</span><br><span class="line">    <span class="keyword">return</span> ci</span><br><span class="line"><span class="comment">#计算密钥长度为x时的重合指数</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">keylength</span>(<span class="params">s,x</span>):</span></span><br><span class="line">	IC=<span class="number">0</span></span><br><span class="line">	s_list=fenzu(s,x)</span><br><span class="line">	<span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(x):	</span><br><span class="line">		num=tongji(s_list[i-<span class="number">1</span>])</span><br><span class="line">		IC+=chong(s_list[i-<span class="number">1</span>],num)</span><br><span class="line">	IC=IC/x</span><br><span class="line">	<span class="keyword">return</span> IC	</span><br><span class="line"><span class="comment">#词频统计</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">tongji</span>(<span class="params">s</span>):</span></span><br><span class="line">	a=<span class="string">&quot;ABCDEFGHIJKLMNOPQRSTUVWXYZ&quot;</span></span><br><span class="line">	num=[]</span><br><span class="line">	<span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">26</span>):</span><br><span class="line">		b=s.count(a[x])</span><br><span class="line">		num.append(b)</span><br><span class="line">	<span class="keyword">return</span> num	</span><br><span class="line"><span class="comment">#计算重合指数</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">chong</span>(<span class="params">s,num</span>):</span></span><br><span class="line">	IC=<span class="number">0</span></span><br><span class="line">	sl=<span class="built_in">len</span>(s)</span><br><span class="line">	<span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">26</span>):</span><br><span class="line">		IC=IC+((num[i]-<span class="number">1</span>)*num[i])/((sl*(sl-<span class="number">1</span>)))</span><br><span class="line">	<span class="keyword">return</span> IC</span><br><span class="line"><span class="comment">#计算拟重合指数,判断分组偏移量</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">nichong</span>(<span class="params">s_biao,kl</span>):</span></span><br><span class="line">	w = [<span class="number">0.08166999999999999</span>, <span class="number">0.01492</span>, <span class="number">0.02782</span>, <span class="number">0.04253</span>, <span class="number">0.12702</span>, <span class="number">0.02228</span>, <span class="number">0.02015</span>, <span class="number">0.06094</span>, <span class="number">0.06966</span>, <span class="number">0.00153</span>, <span class="number">0.00772</span>, <span class="number">0.04025</span>, <span class="number">0.02406</span>, <span class="number">0.06749</span>, <span class="number">0.07507</span>, <span class="number">0.01929</span>, <span class="number">0.00095</span>, <span class="number">0.05987</span>, <span class="number">0.06326999999999999</span>, <span class="number">0.09055999999999999</span>, <span class="number">0.02758</span>, <span class="number">0.00978</span>, <span class="number">0.0236</span>, <span class="number">0.0015</span>, <span class="number">0.01974</span>, <span class="number">0.00074</span>]</span><br><span class="line">	a=<span class="string">&quot;ABCDEFGHIJKLMNOPQRSTUVWXYZ&quot;</span></span><br><span class="line">	v=[]</span><br><span class="line">	k=<span class="number">0</span></span><br><span class="line">	M=<span class="number">0</span></span><br><span class="line">	m=s=<span class="string">&quot;&quot;</span></span><br><span class="line">	<span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(kl):</span><br><span class="line">		v.append(<span class="number">0</span>)</span><br><span class="line">	<span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(kl):</span><br><span class="line">		s_biao[j]=cqu(s_biao[j])</span><br><span class="line">		<span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">26</span>):  <span class="comment">#计算偏移量的</span></span><br><span class="line">			<span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(s_biao[j])):</span><br><span class="line">				m+=<span class="built_in">chr</span>(((<span class="built_in">ord</span>(s_biao[j][i])-<span class="number">65</span>)-((<span class="built_in">ord</span>(a[x])-<span class="number">65</span>)%<span class="number">26</span>)+<span class="number">26</span>)%<span class="number">26</span>+<span class="number">65</span>)</span><br><span class="line">			num=tongji(m)</span><br><span class="line">			<span class="keyword">for</span> e <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">26</span>):</span><br><span class="line">				M=M+(w[e]*num[e]/<span class="built_in">len</span>(s_biao[<span class="number">0</span>]))</span><br><span class="line">			<span class="keyword">if</span> k&lt;M:</span><br><span class="line">				k=M</span><br><span class="line">				v[j]=x</span><br><span class="line">			m=<span class="string">&quot;&quot;</span></span><br><span class="line">			M=<span class="number">0</span></span><br><span class="line">		k=<span class="number">0</span></span><br><span class="line">	<span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(kl):</span><br><span class="line">		s+=<span class="built_in">chr</span>(v[j]+<span class="number">65</span>)</span><br><span class="line">	<span class="keyword">return</span> s</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span>():</span></span><br><span class="line">	<span class="keyword">while</span> (<span class="literal">True</span>):</span><br><span class="line">		<span class="built_in">print</span>(<span class="string">&quot;\n&quot;</span>)</span><br><span class="line">		choice = <span class="built_in">input</span>(<span class="string">&quot;加密请输入1 有密钥解密请输入2 无密钥解密请输入3: &quot;</span>)</span><br><span class="line">		<span class="keyword">if</span> choice == <span class="string">&#x27;1&#x27;</span>:</span><br><span class="line">			m = <span class="built_in">input</span>(<span class="string">&quot;请输入明文: &quot;</span>)</span><br><span class="line">			key = <span class="built_in">input</span>(<span class="string">&quot;请输入密钥: &quot;</span>)</span><br><span class="line">			p=Encrypto(m, key)</span><br><span class="line">			<span class="built_in">print</span>(<span class="string">&quot;加密后的密文是: %s&quot;</span> % p)</span><br><span class="line">		<span class="keyword">elif</span> choice == <span class="string">&#x27;2&#x27;</span>:</span><br><span class="line">			p = <span class="built_in">input</span>(<span class="string">&quot;请输入密文: &quot;</span>)</span><br><span class="line">			key = <span class="built_in">input</span>(<span class="string">&quot;请输入密钥: &quot;</span>)</span><br><span class="line">			m=Decrypto(p, key)</span><br><span class="line">			<span class="built_in">print</span>(<span class="string">&quot;解密后的明文是: %s&quot;</span> % m)</span><br><span class="line">		<span class="keyword">elif</span> choice == <span class="string">&#x27;3&#x27;</span>:</span><br><span class="line">			s = <span class="built_in">input</span>(<span class="string">&quot;请输入密文: &quot;</span>)</span><br><span class="line">			s=cqu(s)</span><br><span class="line">			keylen=miyaochang(s)</span><br><span class="line">			s_biao=fenzu(s,keylen)</span><br><span class="line">			pianyi=nichong(s_biao,keylen)			</span><br><span class="line">			st=Decrypto(s,pianyi)</span><br><span class="line">			<span class="built_in">print</span>(<span class="string">&quot;可能的密钥是：%s&quot;</span>% pianyi)</span><br><span class="line">			<span class="built_in">print</span>(<span class="string">&quot;解密后的明文可能是: %s&quot;</span> % st)</span><br><span class="line">		<span class="keyword">else</span>: <span class="built_in">print</span>(<span class="string">&quot;不存在该口令&quot;</span>)</span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">	main()</span><br></pre></td></tr></table></figure>

<p>就这道题来说，密文是：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">CHREE VOAHM AERAT BIAXX WTNXB EEOPH BSBQM QEQER BWRVX UOAKX AOSXX WEAHB WGJMM QMNKG RFVGX WTRZX WIAKL XFPSK AUTEM NDCMG TSXMX BTUIA DNGMG PSREL XNJEL XVRVP RTULH DNQWT WDTYG BPHXT FALJH ASVBF XNGLL CHRZB WELEK MSJIK NBHWR JGNMG JSGLX FEYPH AGNRB IEQJT AMRVL CRREM NDGLX RRIMG NSNRW CHRQH AEYEV TAQEB BIPEE WEVKA KOEWA DREMX MTBHH CHRTK DNVRZ CHRCL QOHPW QAIIW XNRMG WOIIF KEE</span><br></pre></td></tr></table></figure>

<p>解密结果：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">可能的密钥是：JANET</span><br><span class="line">解密后的明文可能是: the almond tree was in tentative blossom the days were longer often ending with magnificent evenings of corrugated pink skies the hunting season was over with hounds and guns put away for six months the vineyards were busy again as the well organized farmers treated their vines and the more lackadaisical neighbors hurried to do the pruning they should have done in november</span><br></pre></td></tr></table></figure>

<blockquote>
<p>注意，这个破译密文不能太短，越长越准确，密文太短结果都是错。如果大佬有破译短密文（比如一句话的那种），可以教教我交流一下。</p>
<p>密文太短就有了类似于对每个字母都进行了一个凯撒加密，这种情况我觉得只能强行爆破，26^n^太大了，短一点还好说，又短又不够长的那种，就考验电脑性能了吧。</p>
<p>欸，新手菜狗，代码写的有点冗杂，我看他们都一百行出头就写完了。有些太过于罗嗦了为了自己看起来方便，欸，还是再接再厉，多向大佬学习！</p>
</blockquote>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="mailto:undefined">Wang_sang</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="https://laowangh.github.io/2021/11/23/CUMT2021%E7%BB%B4%E5%90%89%E5%B0%BC%E4%BA%9A%E5%AF%86%E7%A0%81/">https://laowangh.github.io/2021/11/23/CUMT2021%E7%BB%B4%E5%90%89%E5%B0%BC%E4%BA%9A%E5%AF%86%E7%A0%81/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://laowangh.github.io" target="_blank">菜狗呜呜呜</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/%E5%AF%86%E7%A0%81%E5%AD%A6/">密码学</a><a class="post-meta__tags" href="/tags/%E9%87%8D%E5%90%88%E6%8C%87%E6%95%B0/">重合指数</a><a class="post-meta__tags" href="/tags/python3/">python3</a></div><div class="post_share"><div class="social-share" data-image="https://cdn.jsdelivr.net/gh/laowangh/cdn@3.0/source/images/thumb/h (5).jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2021/11/27/butterfly%E4%B8%BB%E9%A2%98%E7%BE%8E%E5%8C%96/"><img class="prev-cover" src="https://pic1.zhimg.com/v2-d58ce10bf4e01f5086c604a9cfed29f3_r.jpg?source=1940ef5c" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">butterfly主题美化</div></div></a></div><div class="next-post pull-right"><a href="/2021/11/23/%E5%88%9D%E5%AD%A6Java%E4%B8%80%E6%AC%A1%E7%AE%80%E5%8D%95%E4%BD%9C%E4%B8%9A/"><img class="next-cover" src="https://cdn.jsdelivr.net/gh/laowangh/cdn@3.0/source/images/h (18).jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">初学Java一次简单作业</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><div><a href="/2021/12/01/hill%E5%AF%86%E7%A0%81%E7%9A%84%E5%AD%A6%E4%B9%A0/" title="hill密码的学习"><img class="cover" src="https://cdn.jsdelivr.net/gh/laowangh/cdn@3.0/source/images/thumb/h (25).jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2021-12-01</div><div class="title">hill密码的学习</div></div></a></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="/img/%E5%A4%B4%E5%83%8F1.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">Wang_sang</div><div class="author-info__description"></div></div><div class="card-info-data is-center"><div class="card-info-data-item"><a href="/archives/"><div class="headline">文章</div><div class="length-num">6</div></a></div><div class="card-info-data-item"><a href="/tags/"><div class="headline">标签</div><div class="length-num">12</div></a></div><div class="card-info-data-item"><a href="/categories/"><div class="headline">分类</div><div class="length-num">5</div></a></div></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn card-announcement-animation"></i><span>公告</span></div><div class="announcement_content">希望抱住大佬一起交流</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#0x01-%E7%AE%80%E5%8D%95%E7%9A%84%E5%A4%9A%E8%A1%A8%E4%BB%A3%E6%8D%A2"><span class="toc-number">1.</span> <span class="toc-text">0x01 简单的多表代换</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#0x02-%E5%8D%A1%E5%B8%8C%E6%96%AF%E5%9F%BA%E8%AF%95%E9%AA%8C"><span class="toc-number">2.</span> <span class="toc-text">0x02 卡希斯基试验</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#0x03-%E9%87%8D%E5%90%88%E6%8C%87%E6%95%B0"><span class="toc-number">3.</span> <span class="toc-text">0x03 重合指数</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#0x04-%E6%8B%9F%E9%87%8D%E5%90%88%E6%8C%87%E6%95%B0"><span class="toc-number">4.</span> <span class="toc-text">0x04 拟重合指数</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#0x05-%E6%9C%80%E7%BB%88%E7%BB%93%E6%9E%9C"><span class="toc-number">5.</span> <span class="toc-text">0x05 最终结果</span></a></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2021/12/01/hill%E5%AF%86%E7%A0%81%E7%9A%84%E5%AD%A6%E4%B9%A0/" title="hill密码的学习"><img src="https://cdn.jsdelivr.net/gh/laowangh/cdn@3.0/source/images/thumb/h (25).jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="hill密码的学习"/></a><div class="content"><a class="title" href="/2021/12/01/hill%E5%AF%86%E7%A0%81%E7%9A%84%E5%AD%A6%E4%B9%A0/" title="hill密码的学习">hill密码的学习</a><time datetime="2021-12-01T08:34:18.000Z" title="发表于 2021-12-01 16:34:18">2021-12-01</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2021/11/27/butterfly%E4%B8%BB%E9%A2%98%E7%BE%8E%E5%8C%96/" title="butterfly主题美化"><img src="https://pic1.zhimg.com/v2-d58ce10bf4e01f5086c604a9cfed29f3_r.jpg?source=1940ef5c" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="butterfly主题美化"/></a><div class="content"><a class="title" href="/2021/11/27/butterfly%E4%B8%BB%E9%A2%98%E7%BE%8E%E5%8C%96/" title="butterfly主题美化">butterfly主题美化</a><time datetime="2021-11-27T03:33:23.000Z" title="发表于 2021-11-27 11:33:23">2021-11-27</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2021/11/23/CUMT2021%E7%BB%B4%E5%90%89%E5%B0%BC%E4%BA%9A%E5%AF%86%E7%A0%81/" title="维吉尼亚密码的学习"><img src="https://cdn.jsdelivr.net/gh/laowangh/cdn@3.0/source/images/thumb/h (5).jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="维吉尼亚密码的学习"/></a><div class="content"><a class="title" href="/2021/11/23/CUMT2021%E7%BB%B4%E5%90%89%E5%B0%BC%E4%BA%9A%E5%AF%86%E7%A0%81/" title="维吉尼亚密码的学习">维吉尼亚密码的学习</a><time datetime="2021-11-23T12:42:13.000Z" title="发表于 2021-11-23 20:42:13">2021-11-23</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2021/11/23/%E5%88%9D%E5%AD%A6Java%E4%B8%80%E6%AC%A1%E7%AE%80%E5%8D%95%E4%BD%9C%E4%B8%9A/" title="初学Java一次简单作业"><img src="https://cdn.jsdelivr.net/gh/laowangh/cdn@3.0/source/images/h (18).jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="初学Java一次简单作业"/></a><div class="content"><a class="title" href="/2021/11/23/%E5%88%9D%E5%AD%A6Java%E4%B8%80%E6%AC%A1%E7%AE%80%E5%8D%95%E4%BD%9C%E4%B8%9A/" title="初学Java一次简单作业">初学Java一次简单作业</a><time datetime="2021-11-23T07:39:22.000Z" title="发表于 2021-11-23 15:39:22">2021-11-23</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2021/11/13/html%E8%AF%AD%E6%B3%95%E5%AD%A6%E4%B9%A0/" title="html语法学习"><img src="https://cdn.jsdelivr.net/gh/laowangh/cdn@3.0/source/images/h (18).jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="html语法学习"/></a><div class="content"><a class="title" href="/2021/11/13/html%E8%AF%AD%E6%B3%95%E5%AD%A6%E4%B9%A0/" title="html语法学习">html语法学习</a><time datetime="2021-11-13T13:55:31.000Z" title="发表于 2021-11-13 21:55:31">2021-11-13</time></div></div></div></div></div></div></main><footer id="footer" style="background-image: url('https://cdn.jsdelivr.net/gh/laowangh/cdn@3.0/source/images/h (18).jpg')"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2021 By Wang_sang</div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="translateLink" type="button" title="简繁转换">繁</button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></div><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">本地搜索</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="is-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  数据库加载中</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div><hr/><div id="local-search-results"></div></div></div><div id="search-mask"></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.umd.js"></script><script src="/js/search/local-search.js"></script><div class="js-pjax"><script>if (!window.MathJax) {
  window.MathJax = {
    tex: {
      inlineMath: [ ['$','$'], ["\\(","\\)"]],
      tags: 'ams'
    },
    chtml: {
      scale: 1.2
    },
    options: {
      renderActions: {
        findScript: [10, doc => {
          for (const node of document.querySelectorAll('script[type^="math/tex"]')) {
            const display = !!node.type.match(/; *mode=display/)
            const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display)
            const text = document.createTextNode('')
            node.parentNode.replaceChild(text, node)
            math.start = {node: text, delim: '', n: 0}
            math.end = {node: text, delim: '', n: 0}
            doc.math.push(math)
          }
        }, ''],
        insertScript: [200, () => {
          document.querySelectorAll('mjx-container:not\([display]\)').forEach(node => {
            const target = node.parentNode
            if (target.nodeName.toLowerCase() === 'li') {
              target.parentNode.classList.add('has-jax')
            } else {
              target.classList.add('has-jax')
            }
          });
        }, '', false]
      }
    }
  }
  
  const script = document.createElement('script')
  script.src = 'https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js'
  script.id = 'MathJax-script'
  script.async = true
  document.head.appendChild(script)
} else {
  MathJax.startup.document.state(0)
  MathJax.texReset()
  MathJax.typeset()
}</script></div><script defer="defer" id="fluttering_ribbon" mobile="false" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/canvas-fluttering-ribbon.min.js"></script><script id="canvas_nest" defer="defer" color="0,0,255" opacity="0.8" zIndex="-1" count="120" mobile="false" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/canvas-nest.min.js"></script><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/activate-power-mode.min.js"></script><script>POWERMODE.colorful = true;
POWERMODE.shake = true;
POWERMODE.mobile = false;
document.body.addEventListener('input', POWERMODE);
</script><script id="click-heart" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/click-heart.min.js" async="async" mobile="false"></script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>